package third_party.bsp.stm32f103cb_cube

@Build(stage=1)
@BuildArtifactPath(cppflags="-DSTM32F103xB $(addprefix -I$(EXTERNAL_BUILD_DIR)/third_party/bsp/stmf1cube/cube/STM32CubeF1_master/,Drivers/BSP/STM32F1xx_Nucleo )")
static module stm32f103cb_bsp extends third_party.bsp.stmf1cube.stm32f1_bsp {
	@IncludeExport(path="")
	source "stm32f1xx_hal_conf.h"
}

@Build(stage=1)
@BuildDepends(stm32f103cb_bsp)
@BuildDepends(third_party.bsp.stmf1cube.cube)
static module system_init extends third_party.bsp.st_bsp_api {
	@AddPrefix("^BUILD/extbld/third_party/bsp/stmf1cube/cube")
	source "./STM32CubeF1-master/Drivers/CMSIS/Device/ST/STM32F1xx/Source/Templates/system_stm32f1xx.c"

	depends stm32f103cb_bsp
	depends third_party.bsp.stmf1cube.cube
}

@Build(stage=1)
@BuildDepends(third_party.bsp.stmf1cube.cube)
static module middlewares_fat_fs {
	@DefineMacro("_STR_VOLUME_ID=0")
	/* some data from stm32f7 lib FIXME: Do not use FatFs config from USB_Host/MSC_Standalone */
	@IncludePath("$(EXTERNAL_BUILD_DIR)/third_party/bsp/stmf1cube/cube/STM32CubeF1_master/Middlewares/Third_Party/FatFs/src")
	@AddPrefix("^BUILD/extbld/third_party/bsp/stmf1cube/cube")
	source "./STM32CubeF1_master/Middlewares/Third_Party/FatFs/src/ff.c"
}
